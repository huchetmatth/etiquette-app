<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Sanit-Eticket</title>
</head>
<body>

<h2>Nouvelle production</h2>

<input id="designation" placeholder="Désignation"><br><br>
<input id="poids" placeholder="Poids (kg)"><br><br>
<input id="dlc" type="number" placeholder="DLC (jours)"><br><br>
<input id="operateur" placeholder="Initiales"><br><br>

<button onclick="saveProduction()">Enregistrer</button>

<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>

<script>
  // Ta configuration Firebase
  const firebaseConfig = {
    apiKey: "AIzaSyAL76ws_htNLwAfwvebVX9YPfqtawKUTTk",
    authDomain: "sanit-eticket.firebaseapp.com",
    projectId: "sanit-eticket",
    storageBucket: "sanit-eticket.firebasestorage.app",
    messagingSenderId: "819999183475",
    appId: "1:819999183475:web:becb59ecfb8e7ac185d006",
    measurementId: "G-9B4TJPGJJL"
  };

  // Initialisation de Firebase
  firebase.initializeApp(firebaseConfig);
  const db = firebase.firestore();

  function saveProduction() {
    const designation = document.getElementById("designation").value;
    const poids = document.getElementById("poids").value;
    const dlcDays = parseInt(document.getElementById("dlc").value);
    const operateur = document.getElementById("operateur").value;

    if (!designation || !poids || isNaN(dlcDays)) {
        alert("Veuillez remplir tous les champs correctement.");
        return;
    }

    const today = new Date();
    const dlcDate = new Date();
    dlcDate.setDate(today.getDate() + dlcDays);

    const lot = designation.substring(0,3).toUpperCase() + 
                today.getDate() + 
                (today.getMonth()+1) + 
                today.getFullYear();

    // Envoi vers Firestore
    db.collection("productions").add({
      designation: designation,
      poids: poids,
      dateFabrication: today,
      dateDLC: dlcDate,
      operateur: operateur,
      lot: lot
    })
    .then(() => {
      alert("Production enregistrée avec succès !");
      // Optionnel : vider les champs après l'enregistrement
      document.getElementById("designation").value = "";
      document.getElementById("poids").value = "";
    })
    .catch((error) => {
      console.error("Erreur Firebase : ", error);
      alert("Erreur : " + error.message);
    });
  }
</script>

</body>
</html>
